<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Liste_des_panneaux</title>
  <meta content="" name="description">
  <meta content="" name="keywords">
  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  <!-- Custom CSS -->
  <style>
    .img-fluid {
      max-width: 100px; /* Réglez la taille maximale de l'image ici */
    }
  </style>
</head>

<body>

  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Archive des Panneaux</h3>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped" id="archivespanneauxTable">
                <br> <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#Ajouter">
                  <i class="bi bi-plus"></i> Ajouter
                </button>
                
                <div class="modal fade" id="Ajouter" tabindex="-1">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                      </div>
                      <div class="modal-body">
                        <form id="ajouterForm">
                          <div>
                            <label for="code Face" class="form-label">Code Face:</label>
                            <input type="text" id="code_face" class="form-control" name="code_face" required />
                          </div>
                          <div>
                            <label for="région" class="form-label">Région:</label>
                            <input type="text" id="region" class="form-control" name="region" required />
                          </div>
                          <div>
                            <label for="emplacement" class="form-label">Emplacement:</label>
                            <input type="text" id="emplacement" class="form-control" name="emplacement" required />
                          </div>
                          <div>
                            <label for="type" class="form-label">Type:</label>
                            <input type="text" id="type" class="form-control" name="type" required />
                          </div>
                          <div>
                            <label for="prix" class="form-label">Prix:</label>
                            <input type="text" id="prix" class="form-control" name="prix" required />
                          </div>
                          <div>
                            <label for="trafic routier" class="form-label">Trafic Routier:</label>
                            <input type="text" id="trafic_routier" class="form-control" name="trafic_routier" required />
                          </div>
                          <div>
                            <label for="photo" class="form-label">Photo:</label>
                            <input type="text" id="photo" class="form-control" name="photo" required />
                          </div>
                          
                        </form>
                      </div>
                      <div class="modal-footer">
                        <button type="button" id="submitButton" class="btn btn-success"><i class="bi bi-plus"></i>Ajouter</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal"><i class="bi bi-x"></i>Annuler</button>
                      
                      </div>
                    </div>
                  </div>
                </div>
                &nbsp;&nbsp;
  
                <!-- code  de la confirmation de modifier -->
                <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#Modifier">
                  <i class="bi bi-pencil"></i> Modifier
                </button>
                <div class="modal fade" id="Modifier" tabindex="-1">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                      </div>
                      <div class="modal-body">
                        <form>
                          <div class="mb-3">
                            <label for="editPhoto" class="form-label">Photo</label>
                            <input type="image" class="form-control" id="editPhoto">
                          </div>
                          <div class="mb-3">
                            <label for="editRegion" class="form-label">Region</label>
                            <input type="text" class="form-control" id="editRegion">
                          </div>
                          <div class="mb-3">
                            <label for="editCodeface" class="form-label">Code face</label>
                            <input type="text" class="form-control" id="editCodeface">
                          </div>
                          <div class="mb-3">
                            <label for="editEmplacement" class="form-label">Emplacement</label>
                            <input type="text" class="form-control" id="editEmplacement">
                          </div>
                          <div class="mb-3">
                            <label for="editType" class="form-label">Type</label>
                            <input type="text" class="form-control" id="editType">
                          </div>
                          <div class="mb-3">
                            <label for="editTraficRoutier" class="form-label">Trafic Routier</label>
                            <input type="text" class="form-control" id="editTraficRoutier">
                          </div>
                          
                          <div class="mb-3">
                            <label for="editPrix" class="form-label">Prix</label>
                            <input type="text" class="form-control" id="editPrix" >
                          </div>
                        </form>
                      </div>
                      <div class="modal-footer">
                       <button type="button" class="btn btn-success"><i class="bi bi-check-circle"> </i>Confirmer</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal"><i class="bi bi-x"></i>Annuler</button>
                        
                      </div>
                    </div>
                  </div>
                </div>
                &nbsp;&nbsp;
  
  
                 <!-- code  de la confirmation de suppression -->
                 <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#Supprimer">
                  <i class="bi bi-trash"></i>Supprimer
                </button>
                <div class="modal fade" id="Supprimer" tabindex="-1">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                      </div>
                      <div class="modal-body">
                        Êtes-vous sûr de vouloir supprimer les lignes sélectionnées ?
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                        <button type="button" class="btn btn-danger"><i class="bi bi-trash"></i>Supprimer</button>
                      </div>
                    </div>
                  </div>
                </div>  
           <!-- Button pour ouvrir la fenêtre de confirmation de suppression -->

           <br> <br>
                <thead>
                  <tr>
                    <th></th>
                    
                    <th scope="col">Code face</th>
                    <th scope="col">Region</th>
                    <th scope="col">Emplacement</th>
                    <th scope="col">Type</th>
                    <th scope="col">Prix</th>
                    <th scope="col">Trafic Routier</th>
                    <th scope="col">Photo</th>
                    <th scope="col">Date de création</th>
                    
                  </tr>
                </thead>
                <tbody>
                
                  <!-- Add more rows as needed -->
                </tbody>
              </table>

             
               <!-- code  de la confirmation Ajouter -->
 


            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer mt-5 py-3">
    <div class="copyright">
      <strong><span>Tableau De Bord</span>   <div class="social-links mt-2">
        <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
        <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
        <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
        <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
      </div></strong>
    </div>
  </footer>
  <!-- End Footer -->

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

</body>
<script>
  // Fetch data mta3 el panneaux from the server
  async function fetchData() {
      try {
          const response = await fetch('http://localhost:3001/archivespanneaux/');
          const data = await response.json();
          return data;
      } catch (error) {
          console.error('Error fetching data:', error);
          throw error; // bech n tcheki si famma erreur
      }
  }

  // Populate the table with fetched data
  async function populateTable() {
      try {
          const data = await fetchData();
          const tableBody = document.querySelector('#archivespanneauxTable tbody');

          data.forEach(function (archivespanneau) {
              var row = document.createElement('tr');
              row.innerHTML = `
                  <td><input type="checkbox"</td>
                  <td><a href="#" class="text-primary fw-bold">${archivespanneau.code_face}</a></td>
                  <td>${archivespanneau.region}</td>
                  <td>${archivespanneau.emplacement}</td>
                  <td>${archivespanneau.type}</td>
                  <td>${archivespanneau.prix}</td>
                  <td>${archivespanneau.trafic_routier}</td>
                  <td><img src="${archivespanneau.photo}" style="max-width: 100px; max-height: 100px;"></td>
                  <td>${archivespanneau.cree_a}</td>
              `;
              tableBody.appendChild(row);
          });
      } catch (error) {
          console.error('Error populating table:', error);
      }
  }

  populateTable(); // nedi el function  populateTable() awel ma tet7al el page automatique
  </script>

   <!-- fonction ajouter -->
<script>
  document.getElementById('submitButton').addEventListener('click', async function(event) {
    event.preventDefault(); // Prevent the default button behavior
  
    const formData = new FormData(document.getElementById('ajouterForm')); // Create a FormData object from the form
    for (let pair of formData.entries()) {
      console.log(pair[0] + ': ' + pair[1]);
    }
    try {
      const response = await fetch('http://localhost:3001/archivespanneaux/', {
        method: 'POST',
        body: formData
      });
      
      if (response.ok) {
        const data = await response.json();
        console.log('Panneau added successfully:', data);
        window.location.href = 'ArchivesPanneaux.html';
      } else {
        console.error('Failed to add ArchivesPanneauxprix:', response.statusText);
      }
    } catch (error) {
      console.error('Error adding ArchivesPanneaux:', error);
    }
  });
    
    
    </script>

</html>